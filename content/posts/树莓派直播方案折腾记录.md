---
title: "ğŸŒŠ æ ‘è“æ´¾ç›´æ’­æ–¹æ¡ˆæŠ˜è…¾è®°å½•"
date: 2026-02-26T00:10:00+08:00
---

æ ‘è“æ´¾æ‘„åƒå¤´ç›´æ’­ï¼Œå°è¯•äº†å¤šç§æ–¹æ¡ˆï¼Œè®°å½•ä¸€ä¸‹ã€‚

<!--more-->

## ğŸ“‹ éœ€æ±‚

å°†æ ‘è“æ´¾æ‘„åƒå¤´å®æ—¶æ¨é€åˆ°æµè§ˆå™¨ï¼Œè¦æ±‚**ä½å»¶è¿Ÿ**ã€‚

---

## ğŸš€ å°è¯•çš„æ–¹æ¡ˆ

### 0ï¸âƒ£ rpi-webrtc-streamer (æ”¾å¼ƒ)

å°è¯•ä½¿ç”¨ [rpi-webrtc-streamer](https://github.com/kclyu/rpi-webrtc-streamer) é¡¹ç›®ã€‚

**ç¯å¢ƒé…ç½®**ï¼šå®‰è£…äº†ä¸€å †ä¾èµ–åº“
```
git cmake libwebsocket libjsoncpp libboost-dev
libavformat-dev libavcodec-dev libavutil-dev
libswscale-dev libasound2-dev
```

**é—®é¢˜**ï¼šéœ€è¦ä»æºç ç¼–è¯‘ï¼Œè¿‡ç¨‹è¾ƒå¤æ‚ï¼Œç¯å¢ƒé…ç½®ä¹ŸèŠ±äº†å¾ˆä¹…ï¼Œæœ€ç»ˆæ”¾å¼ƒ âŒ

---

### 1ï¸âƒ£ HLS (HTTP Live Streaming)

libcamera-vid + ffmpeg ç”Ÿæˆ m3u8ï¼Œå»¶è¿Ÿ **2-5 ç§’**ï¼Œå¤ªé«˜ âŒ

### 2ï¸âƒ£ MJPEG

ffmpeg è½¬ç ä¸º Motion JPEGï¼Œé€šè¿‡ nginx æˆ– Python SimpleHTTPServer æ¨é€ã€‚

**é—®é¢˜**ï¼šæµè§ˆå™¨æ’­æ”¾å¡é¡¿ï¼Œä½“éªŒä¸ä½³ âŒ

### 3ï¸âƒ£ WebRTC (æœ€ç»ˆæ–¹æ¡ˆ) âœ…

æ¶æ„æµç¨‹ï¼š

```
libcamera-vid â†’ ffmpeg (æ·»åŠ æ—¶é—´æˆ³) â†’ RTSP â†’ mediamtx â†’ WebRTC
```

æ¨æµå‘½ä»¤ï¼š

```bash
libcamera-vid -t 0 --inline -o - --width 480 --height 270 --framerate 15 \
  | ffmpeg -i - -vf 'drawtext=fontfile=/usr/share/fonts/truetype/dejavu/DejaVuSansMono-Bold.ttf:text=%{localtime}:fontcolor=white:fontsize=20:x=10:y=10:box=1:boxcolor=black@0.5:boxborderw=5' \
  -c:v libx264 -preset ultrafast -tune zerolatency -b:v 500k \
  -f rtsp rtsp://localhost:8554/stream
```

mediamtx é…ç½®ï¼š

| åè®® | ç«¯å£ |
|------|------|
| RTSP | 8554 |
| WebRTC | 8889 |
| HLS | 8888 |

è®¿é—®åœ°å€ï¼š`http://æ ‘è“æ´¾IP:8889/stream/`

---

## ğŸ’¥ é‡åˆ°çš„å‘

1. **ğŸ“· æ‘„åƒå¤´è¢«å ç”¨**
   libcamera-still æˆ–å…¶ä»–è¿›ç¨‹å ç”¨æ‘„åƒå¤´ï¼Œéœ€è¦ `pkill -f libcamera` æ€æ‰

2. **ğŸ”§ ffmpeg ç®¡é“å†™æ³•**
   å¤æ‚ filter éœ€è¦ç”¨å•å¼•å·åŒ…ä½ï¼Œé¿å… shell è½¬ä¹‰é—®é¢˜

3. **ğŸŒ WebRTC è·¨åŸŸ**
   é€šè¿‡ nginx åå‘ä»£ç†æ—¶ï¼Œç›´æ¥ç”¨ 8889 ç«¯å£è®¿é—®æœ€ç¨³å®š

4. **âš™ï¸ mediamtx API**
   éœ€è¦åœ¨é…ç½®ä¸­å¯ç”¨ `api: true`

---

## â±ï¸ å»¶è¿Ÿæµ‹é‡

æœ€ç»ˆå»¶è¿Ÿçº¦ **200-400ms**ï¼Œé€šè¿‡å¯¹æ¯”è§†é¢‘å†…æœåŠ¡å™¨æ—¶é—´æˆ³å’Œå®¢æˆ·ç«¯æ—¶é—´æ‰‹åŠ¨è®¡ç®—ã€‚

æ’­æ”¾åœ°å€ï¼š`http://192.168.x.x:8889/stream/`

å·¦ä¸Šè§’ç™½è‰²æ–‡å­— = æœåŠ¡å™¨æ—¶é—´ï¼Œå¯¹æ¯”ä½ çš„ç”µè„‘æ—¶é—´å³å¯ç®—å‡ºå»¶è¿Ÿã€‚
