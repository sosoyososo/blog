<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="è®°å½•ä¸€äº›é—®é¢˜ï¼Œä¹Ÿè®¸å¯¹å…¶ä»–äººä¹Ÿæœ‰æ‰€åŠ©ç›Š"><title>ğŸŒŠ æ ‘è“æ´¾ç›´æ’­æ–¹æ¡ˆæŠ˜è…¾è®°å½• | Karsa Wang 's Blog</title><link rel=stylesheet href=/css/reset.css><link rel=stylesheet href=/css/font.css><link rel=stylesheet href=/css/smigle.css><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#da532c"><meta name=theme-color content="#ffffff"></head><body><div id=root><header><div id=brand><a class=icon-link href=https://blog.karsa.info/><img class=icon src=/images/brandIcon.svg></a><div class=text><a href=https://blog.karsa.info/><h1>Karsa Wang 's Blog</h1></a><h3>è®°å½•ä¸€äº›é—®é¢˜ï¼Œä¹Ÿè®¸å¯¹å…¶ä»–äººä¹Ÿæœ‰æ‰€åŠ©ç›Š</h3></div></div><nav><a href=/><b>Home</b></a>
|
<a href=/posts><b>Posts</b></a>
|
<a href=/tags><b>Tags</b></a>
|
<a href=/about><b>About</b></a></nav><hr></header><div id=content><main><article><h1 class=title>ğŸŒŠ æ ‘è“æ´¾ç›´æ’­æ–¹æ¡ˆæŠ˜è…¾è®°å½•</h1><div class=post-meta><strong><span>Posted on</span>
<time>2026-02-26 00:10:00</time>
</strong><span>â€¢ 150 words</span>
<span>â€¢ 1 minute read</span></div><div class=content><p>æ ‘è“æ´¾æ‘„åƒå¤´ç›´æ’­ï¼Œå°è¯•äº†å¤šç§æ–¹æ¡ˆï¼Œè®°å½•ä¸€ä¸‹ã€‚</p><h2 id=-éœ€æ±‚>ğŸ“‹ éœ€æ±‚</h2><p>å°†æ ‘è“æ´¾æ‘„åƒå¤´å®æ—¶æ¨é€åˆ°æµè§ˆå™¨ï¼Œè¦æ±‚<strong>ä½å»¶è¿Ÿ</strong>ã€‚</p><hr><h2 id=-å°è¯•çš„æ–¹æ¡ˆ>ğŸš€ å°è¯•çš„æ–¹æ¡ˆ</h2><h3 id=0-rpi-webrtc-streamer-æ”¾å¼ƒ>0ï¸âƒ£ rpi-webrtc-streamer (æ”¾å¼ƒ)</h3><p>å°è¯•ä½¿ç”¨ <a href=https://github.com/kclyu/rpi-webrtc-streamer>rpi-webrtc-streamer</a> é¡¹ç›®ã€‚</p><p><strong>ç¯å¢ƒé…ç½®</strong>ï¼šå®‰è£…äº†ä¸€å †ä¾èµ–åº“</p><pre tabindex=0><code>git cmake libwebsocket libjsoncpp libboost-dev
libavformat-dev libavcodec-dev libavutil-dev
libswscale-dev libasound2-dev
</code></pre><p><strong>é—®é¢˜</strong>ï¼šéœ€è¦ä»æºç ç¼–è¯‘ï¼Œè¿‡ç¨‹è¾ƒå¤æ‚ï¼Œç¯å¢ƒé…ç½®ä¹ŸèŠ±äº†å¾ˆä¹…ï¼Œæœ€ç»ˆæ”¾å¼ƒ âŒ</p><hr><h3 id=1-hls-http-live-streaming>1ï¸âƒ£ HLS (HTTP Live Streaming)</h3><p>libcamera-vid + ffmpeg ç”Ÿæˆ m3u8ï¼Œå»¶è¿Ÿ <strong>2-5 ç§’</strong>ï¼Œå¤ªé«˜ âŒ</p><h3 id=2-mjpeg>2ï¸âƒ£ MJPEG</h3><p>ffmpeg è½¬ç ä¸º Motion JPEGï¼Œé€šè¿‡ nginx æˆ– Python SimpleHTTPServer æ¨é€ã€‚</p><p><strong>é—®é¢˜</strong>ï¼šæµè§ˆå™¨æ’­æ”¾å¡é¡¿ï¼Œä½“éªŒä¸ä½³ âŒ</p><h3 id=3-webrtc-æœ€ç»ˆæ–¹æ¡ˆ->3ï¸âƒ£ WebRTC (æœ€ç»ˆæ–¹æ¡ˆ) âœ…</h3><p>æ¶æ„æµç¨‹ï¼š</p><pre tabindex=0><code>libcamera-vid â†’ ffmpeg (æ·»åŠ æ—¶é—´æˆ³) â†’ RTSP â†’ mediamtx â†’ WebRTC
</code></pre><p>æ¨æµå‘½ä»¤ï¼š</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-text-size-adjust:none><code class=language-bash data-lang=bash><span style=display:flex><span>libcamera-vid -t <span style=color:#ae81ff>0</span> --inline -o - --width <span style=color:#ae81ff>480</span> --height <span style=color:#ae81ff>270</span> --framerate <span style=color:#ae81ff>15</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  | ffmpeg -i - -vf <span style=color:#e6db74>&#39;drawtext=fontfile=/usr/share/fonts/truetype/dejavu/DejaVuSansMono-Bold.ttf:text=%{localtime}:fontcolor=white:fontsize=20:x=10:y=10:box=1:boxcolor=black@0.5:boxborderw=5&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  -c:v libx264 -preset ultrafast -tune zerolatency -b:v 500k <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span>  -f rtsp rtsp://localhost:8554/stream
</span></span></code></pre></div><p>mediamtx é…ç½®ï¼š</p><table><thead><tr><th>åè®®</th><th>ç«¯å£</th></tr></thead><tbody><tr><td>RTSP</td><td>8554</td></tr><tr><td>WebRTC</td><td>8889</td></tr><tr><td>HLS</td><td>8888</td></tr></tbody></table><p>è®¿é—®åœ°å€ï¼š<code>http://æ ‘è“æ´¾IP:8889/stream/</code></p><hr><h2 id=-é‡åˆ°çš„å‘>ğŸ’¥ é‡åˆ°çš„å‘</h2><ol><li><p><strong>ğŸ“· æ‘„åƒå¤´è¢«å ç”¨</strong>
libcamera-still æˆ–å…¶ä»–è¿›ç¨‹å ç”¨æ‘„åƒå¤´ï¼Œéœ€è¦ <code>pkill -f libcamera</code> æ€æ‰</p></li><li><p><strong>ğŸ”§ ffmpeg ç®¡é“å†™æ³•</strong>
å¤æ‚ filter éœ€è¦ç”¨å•å¼•å·åŒ…ä½ï¼Œé¿å… shell è½¬ä¹‰é—®é¢˜</p></li><li><p><strong>ğŸŒ WebRTC è·¨åŸŸ</strong>
é€šè¿‡ nginx åå‘ä»£ç†æ—¶ï¼Œç›´æ¥ç”¨ 8889 ç«¯å£è®¿é—®æœ€ç¨³å®š</p></li><li><p><strong>âš™ï¸ mediamtx API</strong>
éœ€è¦åœ¨é…ç½®ä¸­å¯ç”¨ <code>api: true</code></p></li></ol><hr><h2 id=-å»¶è¿Ÿæµ‹é‡>â±ï¸ å»¶è¿Ÿæµ‹é‡</h2><p>æœ€ç»ˆå»¶è¿Ÿçº¦ <strong>200-400ms</strong>ï¼Œé€šè¿‡å¯¹æ¯”è§†é¢‘å†…æœåŠ¡å™¨æ—¶é—´æˆ³å’Œå®¢æˆ·ç«¯æ—¶é—´æ‰‹åŠ¨è®¡ç®—ã€‚</p><p>æ’­æ”¾åœ°å€ï¼š<code>http://192.168.x.x:8889/stream/</code></p><p>å·¦ä¸Šè§’ç™½è‰²æ–‡å­— = æœåŠ¡å™¨æ—¶é—´ï¼Œå¯¹æ¯”ä½ çš„ç”µè„‘æ—¶é—´å³å¯ç®—å‡ºå»¶è¿Ÿã€‚</p></div></article></main></div><footer><hr><p class=copyright>Copyright Â© 2026
<a href=https://blog.karsa.info/><strong>Karsa Wang</strong></a>.
This work is licensed under the
<a href=http://creativecommons.org/licenses/by-sa/4.0/>CC BY-SA 4.0</a> license.</p><p class=builtWith>Built with
<a href=http://www.gohugo.io/>Hugo</a>,
using the theme
<a href=https://gitlab.com/ian-s-mcb/smigle-hugo-theme>smigle</a>,
which was influenced by the theme
<a href=https://github.com/sumnerevans/smol>smol</a>.</p></footer></div></body></html>